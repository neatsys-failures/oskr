\hypertarget{classoscar_1_1ClientTable}{}\doxysection{oscar\+::Client\+Table$<$ Transport, Reply\+Message $>$ Class Template Reference}
\label{classoscar_1_1ClientTable}\index{oscar::ClientTable$<$ Transport, ReplyMessage $>$@{oscar::ClientTable$<$ Transport, ReplyMessage $>$}}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classoscar_1_1ClientTable_ac8821c80aa35fec93e6a4bd9800781f2}\label{classoscar_1_1ClientTable_ac8821c80aa35fec93e6a4bd9800781f2}} 
using {\bfseries Apply} = std\+::function$<$ void(std\+::function$<$ void(const typename \mbox{\hyperlink{classoscar_1_1Transport_aff91396b76146595e391b69f5e22b93e}{Transport\+::\+Address}} \&remote, const \mbox{\hyperlink{structoscar_1_1ReplyMessage}{Reply\+Message}} \&)$>$)$>$
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
Apply \mbox{\hyperlink{classoscar_1_1ClientTable_a326695a6d4deb0cd3c848cc67526cb6e}{check}} (const typename \mbox{\hyperlink{classoscar_1_1Transport_aff91396b76146595e391b69f5e22b93e}{Transport\+::\+Address}} \&remote, Client\+Id client\+\_\+id, Request\+Number request\+\_\+number)
\item 
void \mbox{\hyperlink{classoscar_1_1ClientTable_ad4eaa81f1e03ab737c6f285e7a7be487}{update}} (Client\+Id client\+\_\+id, Request\+Number request\+\_\+number)
\item 
\mbox{\Hypertarget{classoscar_1_1ClientTable_a5f88955630e89c55b44d104ac778eb2a}\label{classoscar_1_1ClientTable_a5f88955630e89c55b44d104ac778eb2a}} 
Apply {\bfseries update} (Client\+Id client\+\_\+id, Request\+Number request\+\_\+number, \mbox{\hyperlink{structoscar_1_1ReplyMessage}{Reply\+Message}} reply)
\end{DoxyCompactItemize}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classoscar_1_1ClientTable_a326695a6d4deb0cd3c848cc67526cb6e}\label{classoscar_1_1ClientTable_a326695a6d4deb0cd3c848cc67526cb6e}} 
\index{oscar::ClientTable$<$ Transport, ReplyMessage $>$@{oscar::ClientTable$<$ Transport, ReplyMessage $>$}!check@{check}}
\index{check@{check}!oscar::ClientTable$<$ Transport, ReplyMessage $>$@{oscar::ClientTable$<$ Transport, ReplyMessage $>$}}
\doxysubsubsection{\texorpdfstring{check()}{check()}}
{\footnotesize\ttfamily template$<$typename Transport , typename Reply\+Message $>$ \\
Apply \mbox{\hyperlink{classoscar_1_1ClientTable}{oscar\+::\+Client\+Table}}$<$ \mbox{\hyperlink{classoscar_1_1Transport}{Transport}}, \mbox{\hyperlink{structoscar_1_1ReplyMessage}{Reply\+Message}} $>$\+::check (\begin{DoxyParamCaption}\item[{const typename \mbox{\hyperlink{classoscar_1_1Transport_aff91396b76146595e391b69f5e22b93e}{Transport\+::\+Address}} \&}]{remote,  }\item[{Client\+Id}]{client\+\_\+id,  }\item[{Request\+Number}]{request\+\_\+number }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

On direct request from client. 
\begin{DoxyCode}{0}
\DoxyCodeLine{29     \{}
\DoxyCodeLine{30         \textcolor{keyword}{auto} iter = record\_table.find(client\_id);}
\DoxyCodeLine{31         \textcolor{keywordflow}{if} (iter == record\_table.end()) \{}
\DoxyCodeLine{32             record\_table.insert(}
\DoxyCodeLine{33                 \{client\_id, \{remote, request\_number, std::nullopt\}\});}
\DoxyCodeLine{34             \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{35         \}}
\DoxyCodeLine{36 }
\DoxyCodeLine{37         \textcolor{keyword}{auto} \&record = iter-\/>second;}
\DoxyCodeLine{38         \textcolor{keywordflow}{if} (request\_number < record.request\_number) \{}
\DoxyCodeLine{39             \textcolor{keywordflow}{return} [](\textcolor{keyword}{auto}) \{\};}
\DoxyCodeLine{40         \}}
\DoxyCodeLine{41         \textcolor{keywordflow}{if} (request\_number == record.request\_number) \{}
\DoxyCodeLine{42             \textcolor{keywordflow}{if} (!record.reply\_message) \{}
\DoxyCodeLine{43                 \textcolor{keywordflow}{return} [](\textcolor{keyword}{auto}) \{\};}
\DoxyCodeLine{44             \}}
\DoxyCodeLine{45             \textcolor{keywordflow}{return} [remote, reply = *record.reply\_message](\textcolor{keyword}{auto} on\_reply) \{}
\DoxyCodeLine{46                 on\_reply(remote, reply);}
\DoxyCodeLine{47             \};}
\DoxyCodeLine{48         \}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50         \textcolor{keywordflow}{if} (request\_number != record.request\_number + 1) \{}
\DoxyCodeLine{51             panic(}
\DoxyCodeLine{52                 \textcolor{stringliteral}{"{}Not continuous request number: client id = \{\}, \{\} -\/> \{\}"{}},}
\DoxyCodeLine{53                 client\_id, record.request\_number, request\_number);}
\DoxyCodeLine{54         \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56         record.request\_number = request\_number;}
\DoxyCodeLine{57         record.reply\_message = std::nullopt;}
\DoxyCodeLine{58         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{59     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classoscar_1_1ClientTable_ad4eaa81f1e03ab737c6f285e7a7be487}\label{classoscar_1_1ClientTable_ad4eaa81f1e03ab737c6f285e7a7be487}} 
\index{oscar::ClientTable$<$ Transport, ReplyMessage $>$@{oscar::ClientTable$<$ Transport, ReplyMessage $>$}!update@{update}}
\index{update@{update}!oscar::ClientTable$<$ Transport, ReplyMessage $>$@{oscar::ClientTable$<$ Transport, ReplyMessage $>$}}
\doxysubsubsection{\texorpdfstring{update()}{update()}}
{\footnotesize\ttfamily template$<$typename Transport , typename Reply\+Message $>$ \\
void \mbox{\hyperlink{classoscar_1_1ClientTable}{oscar\+::\+Client\+Table}}$<$ \mbox{\hyperlink{classoscar_1_1Transport}{Transport}}, \mbox{\hyperlink{structoscar_1_1ReplyMessage}{Reply\+Message}} $>$\+::update (\begin{DoxyParamCaption}\item[{Client\+Id}]{client\+\_\+id,  }\item[{Request\+Number}]{request\+\_\+number }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

On relayed request message. 
\begin{DoxyCode}{0}
\DoxyCodeLine{64     \{}
\DoxyCodeLine{65         \textcolor{keyword}{auto} iter = record\_table.find(client\_id);}
\DoxyCodeLine{66         \textcolor{keywordflow}{if} (iter == record\_table.end()) \{}
\DoxyCodeLine{67             record\_table.insert(}
\DoxyCodeLine{68                 \{client\_id, \{std::nullopt, request\_number, std::nullopt\}\});}
\DoxyCodeLine{69             \textcolor{keywordflow}{return};}
\DoxyCodeLine{70         \}}
\DoxyCodeLine{71 }
\DoxyCodeLine{72         \textcolor{keywordflow}{if} (iter-\/>second.request\_number >= request\_number) \{}
\DoxyCodeLine{73             warn(}
\DoxyCodeLine{74                 \textcolor{stringliteral}{"{}Ignore late update (request): client id = \{:x\}, request "{}}}
\DoxyCodeLine{75                 \textcolor{stringliteral}{"{}number = \{\}, recorded request = \{\}"{}},}
\DoxyCodeLine{76                 client\_id, request\_number, iter-\/>second.request\_number);}
\DoxyCodeLine{77             \textcolor{keywordflow}{return};}
\DoxyCodeLine{78         \}}
\DoxyCodeLine{79 }
\DoxyCodeLine{80         iter-\/>second.request\_number = request\_number;}
\DoxyCodeLine{81         iter-\/>second.reply\_message.reset();}
\DoxyCodeLine{82     \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
common/Client\+Table.\+hpp\end{DoxyCompactItemize}
